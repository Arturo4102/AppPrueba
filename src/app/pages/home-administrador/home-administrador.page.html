<!-- Encabezado de la página-->
<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Administrador</ion-title>
  </ion-toolbar>
</ion-header>


<!-- Contenido de la página -->
<ion-content [fullscreen]="true">
  <ion-grid>      

    <!-- TAREAS -->
    <ion-row>
      <ion-col>
        <ion-toolbar>
          <ion-title>Tareas:</ion-title>
          <ion-buttons slot="end">
            <!-- Botón de redirección al registro semanal -->
            <ion-button 
              [routerLink]="['/registrosemanaltareas']" 
              class="custom-button">
              
              <ion-label>Tareas de los alumnos</ion-label>
              <ion-icon slot="end" name="calendar-outline"></ion-icon>
            </ion-button>  
          </ion-buttons>

          <!-- Botón para añadir tareas -->
            <ion-buttons slot="end" *ngIf="!showTaskForm">
              <ion-button (click)="toggleTaskForm()">
                <ion-icon slot="icon-only" name="add-circle-outline" color="primary"></ion-icon>
              </ion-button>
            </ion-buttons>

        </ion-toolbar>
        
        <!-- Formulario para añadir una tarea -->
        <ion-card *ngIf="showTaskForm" class="card-add-tarea">
          <ion-toolbar>
            <ion-title>Crear tarea</ion-title>
            <ion-buttons slot="end">
                <ion-button (click)="addTarea()" shape="round" color="primary">Añadir tarea</ion-button>
                <ion-button (click)="toggleTaskForm()" shape="round" color="danger">Cancelar</ion-button>
              </ion-buttons>
          </ion-toolbar>
          <ion-list lines="full">

            <!-- Nombre -->
            <ion-item>
              <ion-input label="Nombre" labelPlacement="floating" type="string" [(ngModel)]="newTarea.Nombre"></ion-input>
            </ion-item>
            
            <!-- Completada -->
            <ion-item>
              <ion-select placeholder="Selecciona estado" label="Completada" [(ngModel)]="newTarea.Completada">
                <ion-select-option [value]="true">Completada</ion-select-option>
                <ion-select-option [value]="false">Pendiente</ion-select-option>
              </ion-select>
            </ion-item>
      
            <!-- OPCIÓN PARA NO PONER FECHA -->
            <!-- Fecha de cumplimiento-->
            <ion-item>
              <ion-label>Fecha de cumplimiento:</ion-label>
              <ion-datetime #datetime locale="es-ES" hourCycle="h12" 
              [(ngModel)]="tempFecha" presentation="date-time">
      
                <ion-buttons slot="buttons">
                  <ion-button color="danger" (click)="datetime.reset()">Resetea</ion-button>
                  <ion-button color="primary" (click)="confirmarFecha()">Aceptar</ion-button>
                </ion-buttons>
              </ion-datetime>
            </ion-item>

            <!-- Mostrar la fecha seleccionada -->
            <ion-item>
              <ion-label>Fecha seleccionada:</ion-label>
              <p *ngIf="newTarea.Fecha; else noFecha">{{ newTarea.Fecha.toDate() | date }}</p>
              <ng-template #noFecha>
                <p>No hay fecha seleccionada</p>
              </ng-template>
            </ion-item>
      
            <!-- Asignado al alumno -->
            <ion-item>
              <ion-select placeholder="Selecciona alumno" label="Asignado a" labelPlacement="floating" [(ngModel)]="newTarea.Asignado">
                <ion-select-option *ngFor="let user of students" [value]="user.nombre">{{user.nombre}}</ion-select-option>
              </ion-select>
            </ion-item>

          </ion-list>
        </ion-card>
      
        <!-- Lista de tareas y todos sus elementos -->
        <ion-list>
          <ion-item *ngFor="let tarea of tareas; let i = index">
            <ion-label>
              <h3>{{ tarea.Nombre }}</h3>
              <p>Completada: {{ tarea.Completada }}</p>
              <p *ngIf="tarea.Fecha">Fecha: {{ tarea.Fecha.toDate() | date }}</p>
              <p *ngIf="tarea.Asignado">Asignado a: {{ tarea.Asignado }}</p>
            </ion-label> 
            <!-- Botones de editar y eliminar la tarea -->
            <ion-buttons slot="end">
              <ion-button (click)="editTarea(tarea)">
                <ion-icon slot="icon-only" name="create" color="primary"></ion-icon>
              </ion-button>
              <ion-button (click)="deleteTarea(tarea)">
                <ion-icon slot="icon-only" name="trash" color="danger"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-item>
        </ion-list>
            
      </ion-col>

        

    <!-- ALUMNOS -->
      <ion-col>
        <ion-toolbar>
          <ion-title>Alumnos:</ion-title>
          <ion-buttons slot="end" *ngIf="!showStudentForm">
            <ion-button (click)="toggleStudentForm()">
              <ion-icon slot="icon-only" name="add-circle-outline" color="primary"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
       
       
        <!-- Formulario de alumnos -->
        <ion-card *ngIf="showStudentForm" class="card-add-tarea">
          <ion-toolbar>
            <ion-title>Crear alumno</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="addStud()" shape="round" color="primary">Añadir alumno</ion-button>
              <ion-button (click)="toggleStudentForm()" shape="round" color="danger">Cancelar</ion-button>
            </ion-buttons>
          </ion-toolbar>
          <ion-list>
            <ion-item>
              <ion-input label="Nombre" labelPlacement="floating" [(ngModel)]="newStud.nombre"></ion-input>
            </ion-item>
            <ion-item>
              <ion-input label="Edad" labelPlacement="floating" type="number" [(ngModel)]="newStud.edad"></ion-input>
            </ion-item>
            <ion-item>
              <ion-input label="Tipo de discapacidad" labelPlacement="floating" [(ngModel)]="newStud.TipoDiscapacidad"></ion-input>
            </ion-item>
          </ion-list>
        </ion-card>

        <!-- Lista de alumnos y todos sus elementos -->
        <ion-list>
        @for (user of students; track $index) {
          <ion-item>
            <ion-label>
              Nombre: {{user.nombre}}
              <p>Edad: {{user.edad}}</p>
              <p>Tipo de Discapacidad: {{user.TipoDiscapacidad.join(', ')}}</p>
            </ion-label>        
            <!-- Botones de editar y eliminar el alumno -->
            <ion-buttons slot="end">
              <ion-button (click)="editStu(user)">
                <ion-icon slot="icon-only" name="create" color="primary"></ion-icon>
              </ion-button>
              <ion-button (click)="deleteStu(user)">
                <ion-icon slot="icon-only" name="trash" color="danger"></ion-icon>
              </ion-button>
            </ion-buttons>       
          </ion-item> 
        }
        </ion-list>    
      </ion-col>


      <!-- PROFESORES -->
      <ion-col>
        <ion-toolbar>
          <ion-title>Profesores:</ion-title>
          <ion-buttons slot="end" *ngIf="!showTeacherForm">
            <ion-button (click)="toggleTeacherForm()">
              <ion-icon slot="icon-only" name="add-circle-outline" color="primary"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>

        <!-- Formulario de profesores -->
        <ion-card *ngIf="showTeacherForm" class="card-add-tarea">
          <ion-toolbar>
            <ion-title>Crear profesor</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="addprof()" shape="round" color="primary">Añadir profesor</ion-button>
              <ion-button (click)="toggleTeacherForm()" shape="round" color="danger">Cancelar</ion-button>
            </ion-buttons>
          </ion-toolbar>
          <ion-list>
            <ion-item>
              <ion-input label="Nombre" labelPlacement="floating" [(ngModel)]="newTeacher.name"></ion-input>
            </ion-item>
            <ion-item>
              <!-- <ion-input label="Edad" labelPlacement="floating" type="number" [(ngModel)]="newTeacher.Edad"></ion-input> -->
            </ion-item>
            <ion-item>
              <ion-checkbox [(ngModel)]="newTeacher.administrative"></ion-checkbox>
              <ion-label>Es administrativo</ion-label>
            </ion-item>
          </ion-list>
        </ion-card>

        <!-- Lista de profesores y todos sus elementos -->
        <ion-list>
        @for (prof of profs; track $index) {
          <ion-item>
            <ion-label>Nombre: {{prof.name}}
              <!-- <p>Edad: {{prof.Edad}}</p> -->
              <p>Es Administrativo: {{prof.administrative}}</p>
            </ion-label>
        
            <ion-buttons slot="end">
              <ion-button (click)="editProf(prof)">
                <ion-icon slot="icon-only" name="create" color="primary"></ion-icon>
              </ion-button>
                    
              <ion-button (click)="(prof)">
                <ion-icon slot="icon-only" name="trash" color="danger"></ion-icon>
              </ion-button>
          
            </ion-buttons>
                  
          </ion-item>
        
        }
        </ion-list>
      </ion-col>
    </ion-row>

  </ion-grid>
</ion-content>

